## Data Preparation

### Data Load and Variable Rename

```{r}
# Load the dataset 'income.csv' into R as a data frame called 'income_data'
zip_path <- "../data/datasets.zip"
file.exists(zip_path)
income_dataset <- read.csv(unz(zip_path, "income.csv"))
head(income_dataset)
# data column name exploration 
str(income_dataset)

# remove unnecessary columns and rename the feature names as `income` and `children`.
income <- income_dataset$Total.Household.Income
children <- income_dataset$Members.with.age.5...17.years.old
```

### Initial Exploration Of Target Variable 'income' And 'children'

```{r}
# Print the first few rows of the data
cat("First few rows of Household Income:\n", head(income), "\n\n")
cat("First few rows of Number of Children:\n", head(children), "\n\n")

# Check for missing values
cat("Number of missing values in Household Income:", sum(is.na(income)), "\n")
cat("Number of missing values in Number of Children:", sum(is.na(children)), "\n")

# Print summaries in a concise way without storing the summaries separately
cat("\nSummary of Household Income:\n", 
    paste(names(summary(income)), summary(income), sep = " = ", collapse = "\n"), "\n\n")

cat("Summary of Number of Children:\n", 
    paste(names(summary(children)), summary(children), sep = " = ", collapse = "\n"), "\n")
```

### Scatter plot of income vs. children

```{r}
# Scatter plot of income vs. children
plot(children, income/10000, xlab = "Number of Children", ylab = "Household Income (in 10 Thousands)", main = "Income vs. Children")
```

## Linear Regression

### Training Set And Testing Set Preparation

```{r}
# Set a seed for reproducibility
set.seed(888)  # seed number could be modified, here I use seed for reduce RAM pressure \n in compution when smaple size is over 40000.
# Combine income and children into a data frame
data <- data.frame(income = income, children = children)
# Split the data into training (80%) and test sets (20%)
train_data <- data[sample(1:nrow(data), size = 0.8 * nrow(data)), ]
test_data <- data[-sample(1:nrow(data), size = 0.8 * nrow(data)), ]

```

### Model Trainning

```{r}
# Fit a linear regression model
model <- lm(income ~ children, data = train_data)

# Print the summary of the model
summary(model)

```

### Model Explanation

1.  What is the specific form of the affine-linear model, i.e. what are `b0` and `b1`?

-   The affine-linear model or SLR model (simple linear regression model) has the general form: $\text{income} = b_0 + b_1 \cdot \text{children}$

-   $b_0$ is the **intercept** (the value of income when children = 0). Our model's $b_0= 262735$

-   $b_1$ is the **slope** (the change in income for a one-unit increase in children). Our model's $b_1= -11256$

-   So the specific form of our SLR model is:

    $\text{income} = 262735 −11256 \cdot \text{children}$

2.  What is the predicted mean income of a household with $𝑛$ children, for $\text{n} ∈ \{0,1,…,8\}$? What are the associated 90% prediction intervals? Summarize all of this in a table.

    income of a household with $𝑛$ children

    Children Number ( \$N\$ ) \| Income

    0\|

```{r}
n <- array(0:8)
b_0 <- 262735
b_1 <- -11256
income_n <- b_0+b_1*n
cat(paste0("The predicted mean income of a household with 0-8 children = ",mean(income_n)),"\n")
```

When the sample number $\text{n}=8$, which is very small, we could .... (to be continue)

2.  Using your test set, check how many percent of datapoints lie within the 90% prediction intervals.

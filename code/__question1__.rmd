---
title: "STAT462:  Assignment 1: Q1 - Work in Progress"
author: "Simon Clarke Student ID:97211898"
date: "2025-03-12"
output:
  word_document: default
  toc: true
  number_sections: true
  toc_float: true
  pdf_document: default
  html_document: null
---

```{=html}
<style>
.boxTask {
background-color: lightblue;
color: black;
border: 2px solid black;
margin: 5px;
padding: 5px;
font-style: italic;
}


.boxNote {
background-color: Tomato;
color: black;
border: 2px solid black;
margin: 5px;
padding: 5px;
}

.fill-in-blank {
background-color: lightyellow;
border: 2px solid #6f2c87;
}

</style>
```

```{r setup, include=TRUE}
Sys.setenv(LANG = "en")
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(ggplot2)
library(readxl)

```

## Braking Distance

### 1.  Loading The Dataset

#### Loading the dataset (braking.csv)
```{r eval = TRUE}
# shows what directory your working directory is
getwd()

# sets workinG directory -  
# SUMMER / DAVID, THIS WILL HAVE TO BE CHANGED TO IMPORT MY FILE TO WORKING DIRECTORY YOU'RE USING
setwd("C:/Users/Simon/OneDrive - University of Canterbury/DataMinSTAT462/Group Assignment")

# to read a csv file from above folder
bdata <- read.csv("braking.csv")

# data exploration
head(bdata)  # shows the start of the data
tail(bdata)  # shows end of the data
str(bdata)   # shows the data structure/description
summary(bdata)  #summarises numerical data


```
#### Imperial units converted to metric units

```{r eval = TRUE}

# Miles converted to kilometers per hour (for speed)
bdata$speed_kmph <- bdata$speed * 1.60934

# Feet converted metres (for distance)
bdata$dist_m <- bdata$dist * 0.3048

# Delete imperial measurement columns
bdata_m <- subset(bdata, select = -c(speed, dist))

# view(bdata_m)

```


#### Dataset split randomly into a training set (80%) and test set (20%)

```{r eval = TRUE}
set.seed(1)

# Split randomly into training set (80%)
train_ind <- sample(1:50, size = 50 * 0.8)

df_train <- bdata_m[train_ind, ]

# Split randomly into training set (20%)

df_test <- bdata_m[-train_ind, ]  #- sign in front onf vector excludes from indexing 

```

#### (Extra) Scatter Plot Of Train Data

```{r}
trainplot <- ggplot(data = df_train, aes(x = speed_kmph, y = dist_m)) +
  geom_point(colour ="black", alpha = 0.3)

trainplot

```

### 2.  Simple Linear Regression (SLR) (without using lm function)

#### Code To Calculate for Slope (B1) and intercept (B0)

```{r include=FALSE, eval=TRUE}
b1 <- sum((df_train$speed_kmph - mean(df_train$speed_kmph)) * (df_train$dist_m - mean(df_train$dist_m))) / sum((df_train$speed_kmph - mean(df_train$speed_kmph))^2)

b0 <- mean(df_train$dist_m) - b1 * mean(df_train$speed_kmph)
```


#### a. SLR model forecast:

In this linear regression model, if you increase your speed by 5km/h, this model predicts that you will need 1.93m (2 d.p.) of additional braking distance, with everything else being equal.

#====> sign below doesn't look like it's around the right way.

```{r}
b0 + b1 * 5

```
In this linear regression model, if you increase your speed by 5km/h, this model predicts that you will need X more metres of braking distance, with everything else being equal.

#### b.  

X % of the variation in the data can be explained by this linear regression model.  This is because XYZ.

#### c.  

Speed is/not a significant predictor for dist (distance) at the 95% confidence level.  This is because XYZ.

#### d.

```{r}
b0 + b1 * 30

```

Based on this linear regression model, it can be predicated that ....with 80% confidence.xxxxx



### 3.  K-NN model

# provide the x of a new point, gets the corresponding y estimation
#### Step 1:  Create the kNN function (k=3) - based on scatter plot above
```{r eval=FALSE, include=TRUE}

kNN3 <- function(x){
  neighbourhood_vals <- df_train %>% # piping operator
    # generate distances between new x and each existing x
    mutate(disttest = abs(speed_kmph-x)) #mutate adds a new column
    # sorting the distance
    arrange(disttest) %>% # arranges xdist column rows in ascending order (default)
    #subset the first k rows
    slice(1:3) %>% # slice() is used to subset rows of a df based on their interger positions
      
    #select target response (y-value column)
    select(dist_m)
  
  # take the average response as the estimate for y
  return (sum(neighbour_vals)/3)
}

```

#### Step 2: KNN Model distance Prediction

```{r eval=TRUE, include=TRUE}
#kNN3(10)

```

### 4. Visualisation of SLR and kNN Models

#### Visualisation of Both Models Combined
```{r eval=FALSE, include=TRUE}

# p is the plot with the scatter layer
p + 
  # add a layer for kNN21 model
  geom_function(fun = function(x) {sapply(x, kNN3)}, aes(col =
  "k-NN")) +
    # add a layer for SLR model
    geom_abline(aes(slope = b1, intercept = b0, col = "SLR" ), show.legend = FALSE) +
    # add a legend for descrption
    scale_colour_manual(name = "Model fit", values = c("red", "blue"))


```


#### Perfomance of Both Models (on Test dataset)


### 5  

